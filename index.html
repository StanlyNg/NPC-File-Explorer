<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NPC File Explorer — 演示版</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#94a3b8; --accent:#1E90FF; --glass: rgba(255,255,255,0.04);
      --text:#e6eef8; --danger:#f43f5e; --white:#fff; --radius:14px;
    }
    [data-theme="light"]{
      --bg:#f6f9fc; --card:#ffffff; --muted:#546069; --accent:#0366d6; --glass: rgba(0,0,0,0.04);
      --text:#0b1220; --danger:#b91c1c; --white:#fff;
    }
    body{margin:0;font-family:sans-serif;background:var(--bg);color:var(--text)}
    .container{max-width:1080px;margin:20px auto;padding:20px}
    .file{padding:12px;margin:8px;background:var(--card);border-radius:var(--radius);cursor:pointer}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1000}
    .modal{background:var(--card);padding:20px;border-radius:var(--radius);max-width:90%;max-height:90%;overflow:auto;color:var(--text)}
    .btn{padding:8px 12px;background:var(--accent);color:white;border:none;border-radius:8px;cursor:pointer;margin:5px 0}
    .file-info{font-size:0.9em;color:var(--muted);margin-top:4px}
  </style>
</head>
<body data-theme="dark">
  <div class="container">
    <h1>NPC File Explorer</h1>
    <input type="file" id="fileInput" multiple />
    <div id="filesContainer"></div>
  </div>
  <div id="modal" class="modal-backdrop">
    <div class="modal">
      <button id="closeModal" class="btn">关闭</button>
      <div id="fileDetails"></div>
      <pre id="fileContent"></pre>
    </div>
  </div>
  <script>
    const filesContainer = document.getElementById('filesContainer');
    const fileInput = document.getElementById('fileInput');
    const modal = document.getElementById('modal');
    const fileContent = document.getElementById('fileContent');
    const fileDetails = document.getElementById('fileDetails');
    const closeModal = document.getElementById('closeModal');

    let files = [];

    function renderFiles(){
      filesContainer.innerHTML = '';
      files.forEach((f,i)=>{
        const div = document.createElement('div');
        div.className = 'file';
        div.innerHTML = `<strong>${f.name}</strong><div class="file-info">${(f.size/1024).toFixed(2)} KB | ${f.type || '未知类型'}</div>`;
        div.addEventListener('click', ()=>showFile(i));
        filesContainer.appendChild(div);
      });
    }

    function showFile(index){
      const file = files[index];
      fileDetails.innerHTML = `<p><strong>文件名:</strong> ${file.name}</p>
        <p><strong>大小:</strong> ${(file.size/1024).toFixed(2)} KB</p>
        <p><strong>类型:</strong> ${file.type || '未知类型'}</p>
        <p><strong>最后修改:</strong> ${new Date(file.lastModified).toLocaleString()}</p>`;
      const reader = new FileReader();
      reader.onload = e => {
        fileContent.textContent = e.target.result;
        modal.style.display = 'flex';
      };
      if(file.type.startsWith('text') || file.type===''){ reader.readAsText(file); }
      else{ fileContent.textContent = '无法预览此文件类型'; modal.style.display = 'flex'; }
    }

    fileInput.addEventListener('change', e => {
      files = Array.from(e.target.files);
      renderFiles();
    });

    closeModal.addEventListener('click', ()=>{ modal.style.display = 'none'; });
    modal.addEventListener('click', e=>{ if(e.target===modal) modal.style.display='none'; });
  </script>
</body>
</html>
